  'use strict';
  import Provider from '../Provider.js';
  import {expect, assert} from 'chai';

  let provider = Provider();
  let mockData = {"[\"moreinfo\",{\"action\":\"moreInfo\",\"params\":{\"identifier\":[{\"localIdentifier\":\"28448716\",\"libraryCode\":\"870970\"}]},\"config\":{\"authentication\":{\"authenticationUser\":\"XXXXX\",\"authenticationGroup\":\"XXXXX\",\"authenticationPassword\":\"XXXXX\"}}}]":{"requestStatus":{"statusEnum":"ok","errorText":{}},"identifierInformation":[{"identifierKnown":true,"identifier":{"localIdentifier":"28448716","libraryCode":"870970"},"coverImage":[{"attributes":{"imageSize":"detail_117","imageFormat":"jpeg"},"$value":"http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_117&key=acc5a21fb6f04ab51224"},{"attributes":{"imageSize":"detail_207","imageFormat":"jpeg"},"$value":"http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_207&key=e58bbb172c7ea5492976"},{"attributes":{"imageSize":"detail_42","imageFormat":"jpeg"},"$value":"http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_42&key=4a208ece2246310ff447"},{"attributes":{"imageSize":"detail_500","imageFormat":"jpeg"},"$value":"http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_500&key=6746270edeef7903c8a1"},{"attributes":{"imageSize":"thumbnail","imageFormat":"jpeg"},"$value":"http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_lille&key=6b4d18398fc3f100fd59"},{"attributes":{"imageSize":"detail","imageFormat":"jpeg"},"$value":"http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_stor&key=00146f25b073bb900398"}],"backPage":["http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=bagside_pdf&key=b241454ce7679bd57d2d"]}],"raw":"<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n<soapenv:Body><mi:moreInfoResponse xmlns:mi=\"http://oss.dbc.dk/ns/moreinfo\">\n  <mi:requestStatus>\n    <mi:statusEnum>ok</mi:statusEnum>\n    <mi:errorText></mi:errorText>\n  </mi:requestStatus>\n  <mi:identifierInformation>\n    <mi:identifierKnown>true</mi:identifierKnown>\n    <mi:identifier>\n      <mi:localIdentifier>28448716</mi:localIdentifier>\n      <mi:libraryCode>870970</mi:libraryCode>\n    </mi:identifier>\n    <mi:coverImage imageSize=\"detail_117\" imageFormat=\"jpeg\">http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&amp;type=forside_117&amp;key=acc5a21fb6f04ab51224</mi:coverImage>\n    <mi:coverImage imageSize=\"detail_207\" imageFormat=\"jpeg\">http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&amp;type=forside_207&amp;key=e58bbb172c7ea5492976</mi:coverImage>\n    <mi:coverImage imageSize=\"detail_42\" imageFormat=\"jpeg\">http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&amp;type=forside_42&amp;key=4a208ece2246310ff447</mi:coverImage>\n    <mi:coverImage imageSize=\"detail_500\" imageFormat=\"jpeg\">http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&amp;type=forside_500&amp;key=6746270edeef7903c8a1</mi:coverImage>\n    <mi:coverImage imageSize=\"thumbnail\" imageFormat=\"jpeg\">http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&amp;type=forside_lille&amp;key=6b4d18398fc3f100fd59</mi:coverImage>\n    <mi:coverImage imageSize=\"detail\" imageFormat=\"jpeg\">http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&amp;type=forside_stor&amp;key=00146f25b073bb900398</mi:coverImage>\n    <mi:backPage>http://moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&amp;type=bagside_pdf&amp;key=b241454ce7679bd57d2d</mi:backPage>\n  </mi:identifierInformation>\n</mi:moreInfoResponse>\n</soapenv:Body>\n</soapenv:Envelope>"},"undefined":{"statusCode":200,"data":[{"coverUrl117":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_117&key=acc5a21fb6f04ab51224"],"coverUrl207":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_207&key=e58bbb172c7ea5492976"],"coverUrl42":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_42&key=4a208ece2246310ff447"],"coverUrl500":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_500&key=6746270edeef7903c8a1"],"coverUrlThumbnail":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_lille&key=6b4d18398fc3f100fd59"],"coverUrlFull":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_stor&key=00146f25b073bb900398"]}]}}

  describe('Automated test of the work endpoint', () => {
    it('expected response. ID:1owsuj, for {"pids":["870970-basis:28448716"],"fields":["coverUrlFull"],"pretty":true}', (done) => {
      let context = {"opensearch":{"url":"http://opensearch.addi.dk/b3.0_4.2/","agency":775100,"profile":"opac"},"moreinfo":{"url":"http://moreinfo.addi.dk/2.1/","user":"XXXXX","group":"XXXXX","password":"XXXXX"},"popsuggest":{"url":"http://xptest.dbc.dk/ms/entity-pop/v1"},"creatorsuggest":{"url":"http://xptest.dbc.dk/ms/entity-suggest/v1/creator"},"librarysuggest":{"url":"http://xptest.dbc.dk/ms/entity-suggest/v1/library","librarytype":"folkebibliotek"},"subjectsuggest":{"url":"http://xptest.dbc.dk/ms/entity-suggest/v1/subject"},"userstatus":{"url":"https://openuserstatus.addi.dk/1.4.1/","userid":"XXXXX","userpin":"XXXXX","useragency":"DK-100450","authgroupid":"XXXXX","authpassword":"XXXXX","authid":"XXXXX"},"recommend":{"url":"http://xptest.dbc.dk/ms/recommend-cosim/v1","filters":["rec.collectionIdentifier:150031-sted OR rec.collectionIdentifier:150031-tema OR rec.collectionIdentifier:775100-katalog OR rec.collectionIdentifier:150033-dandyr OR rec.collectionIdentifier:150008-public OR rec.collectionIdentifier:150052-ekurser OR rec.collectionIdentifier:150015-ereol OR rec.collectionIdentifier:150061-ebog OR rec.collectionIdentifier:150061-netlydbog OR rec.collectionIdentifier:150015-erelic OR rec.collectionIdentifier:870971-faktalink OR rec.collectionIdentifier:150022-alle OR rec.collectionIdentifier:150021-fjern OR rec.collectionIdentifier:870971-forfweb OR rec.collectionIdentifier:150012-ordbog OR rec.collectionIdentifier:150043-atlas OR rec.collectionIdentifier:150005-analyse OR rec.collectionIdentifier:150005-artikel OR rec.collectionIdentifier:150005-portraet OR rec.collectionIdentifier:159014-lokalbibl OR rec.collectionIdentifier:150015-netlydbog OR rec.collectionIdentifier:150060-pressdisp OR rec.collectionIdentifier:150044-safari OR rec.collectionIdentifier:150023-sicref OR rec.collectionIdentifier:150053-turteori OR rec.collectionIdentifier:150033-verdyr OR rec.collectionIdentifier:150059-magasin"]},"openagency":{"url":"http://openagency.addi.dk/2.24/","agency":775100},"openholdingstatus":{"url":"https://openholdingstatus.addi.dk/2.2/","agency":775100,"authgroupid":"XXXXX","authpassword":"XXXXX","authid":"XXXXX"}};
      context.mockData = mockData;
      provider.execute('work', {"pids":["870970-basis:28448716"],"fields":["coverUrlFull"],"pretty":true}, context)
        .then(result => {
          assert.deepEqual(result,
              {"statusCode":200,"data":[{"coverUrl117":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_117&key=acc5a21fb6f04ab51224"],"coverUrl207":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_207&key=e58bbb172c7ea5492976"],"coverUrl42":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_42&key=4a208ece2246310ff447"],"coverUrl500":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_500&key=6746270edeef7903c8a1"],"coverUrlThumbnail":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_lille&key=6b4d18398fc3f100fd59"],"coverUrlFull":["//moreinfo.addi.dk/2.1/more_info_get.php?id=50929213&type=forside_stor&key=00146f25b073bb900398"]}]});
          done();
        });
    })
  });